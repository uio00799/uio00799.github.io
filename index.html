<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>GitHub Repository Scanner v1.0</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');
  
  * { margin: 0; padding: 0; box-sizing: border-box; }
  
  body {
    font-family: 'VT323', monospace;
    background: #000;
    color: #0f0;
    font-size: 18px;
    line-height: 1.4;
    padding: 20px;
    letter-spacing: 1px;
    text-shadow: 0 0 5px #0f0;
  }
  
  .scanline {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      to bottom,
      rgba(255, 255, 255, 0) 50%,
      rgba(0, 255, 0, 0.02) 51%
    );
    background-size: 100% 4px;
    pointer-events: none;
    z-index: 9999;
    animation: scanline 8s linear infinite;
  }
  
  @keyframes scanline {
    0% { background-position: 0 0; }
    100% { background-position: 0 100%; }
  }
  
  @keyframes blink {
    0%, 49% { opacity: 1; }
    50%, 100% { opacity: 0; }
  }
  
  .container {
    max-width: 1200px;
    margin: 0 auto;
    border: 2px solid #0f0;
    padding: 20px;
    background: rgba(0, 20, 0, 0.9);
    box-shadow: 0 0 20px #0f0;
  }
  
  .header {
    border-bottom: 2px solid #0f0;
    padding-bottom: 15px;
    margin-bottom: 20px;
  }
  
  .header h1 {
    font-size: 32px;
    margin-bottom: 5px;
  }
  
  .header .version {
    font-size: 16px;
    color: #0a0;
  }
  
  .cursor {
    display: inline-block;
    width: 10px;
    height: 18px;
    background: #0f0;
    animation: blink 1s infinite;
    margin-left: 5px;
  }
  
  .input-group {
    margin-bottom: 20px;
    padding: 15px;
    border: 1px solid #0a0;
    background: rgba(0, 40, 0, 0.5);
  }
  
  .input-row {
    display: flex;
    gap: 10px;
    margin-bottom: 10px;
    align-items: center;
    flex-wrap: wrap;
  }
  
  label {
    color: #0f0;
    min-width: 120px;
  }
  
  input[type="text"], select {
    background: #000;
    color: #0f0;
    border: 1px solid #0f0;
    padding: 5px 10px;
    font-family: 'VT323', monospace;
    font-size: 18px;
    flex: 1;
    min-width: 200px;
  }
  
  input[type="text"]:focus, select:focus {
    outline: none;
    box-shadow: 0 0 10px #0f0;
  }
  
  button {
    background: #000;
    color: #0f0;
    border: 2px solid #0f0;
    padding: 8px 20px;
    font-family: 'VT323', monospace;
    font-size: 18px;
    cursor: pointer;
    transition: all 0.2s;
  }
  
  button:hover {
    background: #0f0;
    color: #000;
    box-shadow: 0 0 15px #0f0;
  }
  
  button:active {
    transform: scale(0.95);
  }
  
  .status {
    padding: 10px;
    margin-bottom: 15px;
    border: 1px solid #0a0;
    background: rgba(0, 40, 0, 0.5);
    font-size: 16px;
  }
  
  .status.loading {
    animation: blink 1s infinite;
  }
  
  .status.error {
    color: #f00;
    text-shadow: 0 0 5px #f00;
    border-color: #f00;
  }
  
  .status.success {
    color: #0ff;
    text-shadow: 0 0 5px #0ff;
    border-color: #0ff;
  }
  
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
    font-size: 16px;
  }
  
  th {
    background: #0a0;
    color: #000;
    padding: 10px;
    text-align: left;
    border: 1px solid #0f0;
  }
  
  td {
    padding: 8px 10px;
    border: 1px solid #0a0;
    border-top: none;
  }
  
  tr:hover {
    background: rgba(0, 255, 0, 0.1);
  }
  
  a {
    color: #0ff;
    text-decoration: none;
    text-shadow: 0 0 3px #0ff;
  }
  
  a:hover {
    text-decoration: underline;
    text-shadow: 0 0 8px #0ff;
  }
  
  .file-icon {
    margin-right: 5px;
  }
  
  .stats {
    display: flex;
    gap: 20px;
    margin-bottom: 15px;
    padding: 10px;
    border: 1px solid #0a0;
    background: rgba(0, 40, 0, 0.5);
    flex-wrap: wrap;
  }
  
  .stat-item {
    display: flex;
    gap: 5px;
  }
  
  .stat-label {
    color: #0a0;
  }
  
  .stat-value {
    color: #0ff;
  }
  
  .no-data {
    text-align: center;
    padding: 40px;
    color: #0a0;
    font-size: 20px;
  }
</style>
</head>
<body>
<div class="scanline"></div>

<div class="container">
  <div class="header">
    <h1>â–ˆ GITHUB REPOSITORY SCANNER â–ˆ</h1>
    <div class="version">BIOS VERSION 1.0 | SYSTEM READY<span class="cursor"></span></div>
  </div>
  
  <div class="input-group">
    <div class="input-row">
      <label>REPO URL:</label>
      <input type="text" id="repoUrl" placeholder="https://github.com/username/repository">
      <button id="scanBtn">â–º SCAN REPO</button>
    </div>
    
    <div class="input-row">
      <label>BRANCH:</label>
      <input type="text" id="branch" placeholder="main" value="main">
    </div>
    
    <div class="input-row">
      <label>FILTER EXT:</label>
      <select id="extFilter">
        <option value="">ALL FILES</option>
        <option value=".html">HTML</option>
        <option value=".htm">HTM</option>
        <option value=".php">PHP</option>
        <option value=".js">JAVASCRIPT</option>
        <option value=".css">CSS</option>
        <option value=".json">JSON</option>
        <option value=".md">MARKDOWN</option>
        <option value=".txt">TEXT</option>
        <option value=".py">PYTHON</option>
        <option value=".java">JAVA</option>
        <option value=".c">C</option>
        <option value=".cpp">C++</option>
        <option value=".png">PNG</option>
        <option value=".jpg">JPG</option>
        <option value=".gif">GIF</option>
        <option value=".svg">SVG</option>
      </select>
      
      <label style="min-width: 80px;">SEARCH:</label>
      <input type="text" id="searchBox" placeholder="filename...">
    </div>
  </div>
  
  <div id="status" class="status">SYSTEM IDLE - ENTER REPOSITORY URL TO BEGIN</div>
  
  <div id="statsArea" style="display: none;" class="stats">
    <div class="stat-item">
      <span class="stat-label">TOTAL FILES:</span>
      <span class="stat-value" id="totalFiles">0</span>
    </div>
    <div class="stat-item">
      <span class="stat-label">DISPLAYED:</span>
      <span class="stat-value" id="displayedFiles">0</span>
    </div>
    <div class="stat-item">
      <span class="stat-label">TOTAL SIZE:</span>
      <span class="stat-value" id="totalSize">0 KB</span>
    </div>
  </div>
  
  <div id="tableContainer" style="display: none;">
    <table id="fileTable">
      <thead>
        <tr>
          <th>FILE PATH</th>
          <th>SIZE</th>
          <th>TYPE</th>
          <th>ACTION</th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>
  </div>
  
  <div id="noData" class="no-data" style="display: none;">
    NO FILES FOUND - CHECK FILTERS OR SCAN REPOSITORY
  </div>
</div>

<script>
const statusEl = document.getElementById('status');
const tableBody = document.getElementById('tableBody');
const tableContainer = document.getElementById('tableContainer');
const noData = document.getElementById('noData');
const statsArea = document.getElementById('statsArea');
const repoUrlInput = document.getElementById('repoUrl');
const branchInput = document.getElementById('branch');
const extFilter = document.getElementById('extFilter');
const searchBox = document.getElementById('searchBox');
const scanBtn = document.getElementById('scanBtn');

let allFiles = [];

function setStatus(text, type = '') {
  statusEl.textContent = text;
  statusEl.className = 'status ' + type;
}

function formatBytes(bytes) {
  if (!bytes) return '0 B';
  const k = 1024;
  const sizes = ['B', 'KB', 'MB', 'GB'];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
}

function getFileIcon(path) {
  const ext = path.split('.').pop().toLowerCase();
  const icons = {
    'html': 'ðŸ“„', 'htm': 'ðŸ“„', 'php': 'ðŸ˜', 'js': 'ðŸ“œ', 'css': 'ðŸŽ¨',
    'json': 'ðŸ“‹', 'md': 'ðŸ“', 'txt': 'ðŸ“ƒ', 'py': 'ðŸ', 'java': 'â˜•',
    'png': 'ðŸ–¼ï¸', 'jpg': 'ðŸ–¼ï¸', 'jpeg': 'ðŸ–¼ï¸', 'gif': 'ðŸ–¼ï¸', 'svg': 'ðŸŽ¨',
    'pdf': 'ðŸ“•', 'zip': 'ðŸ“¦', 'mp3': 'ðŸŽµ', 'mp4': 'ðŸŽ¬'
  };
  return icons[ext] || 'ðŸ“„';
}

function parseGitHubUrl(url) {
  const match = url.match(/github\.com\/([^\/]+)\/([^\/]+)/);
  if (!match) return null;
  return { owner: match[1], repo: match[2].replace('.git', '') };
}

async function fetchRepoTree(owner, repo, branch) {
  const apiUrl = `https://api.github.com/repos/${owner}/${repo}/git/trees/${branch}?recursive=1`;
  const response = await fetch(apiUrl);
  
  if (!response.ok) {
    throw new Error(`GitHub API Error: ${response.status} - ${response.statusText}`);
  }
  
  return await response.json();
}

async function scanRepository() {
  const url = repoUrlInput.value.trim();
  const branch = branchInput.value.trim() || 'main';
  
  if (!url) {
    setStatus('ERROR: REPOSITORY URL REQUIRED', 'error');
    return;
  }
  
  const parsed = parseGitHubUrl(url);
  if (!parsed) {
    setStatus('ERROR: INVALID GITHUB URL FORMAT', 'error');
    return;
  }
  
  setStatus('SCANNING REPOSITORY... PLEASE WAIT', 'loading');
  tableContainer.style.display = 'none';
  noData.style.display = 'none';
  statsArea.style.display = 'none';
  
  try {
    const data = await fetchRepoTree(parsed.owner, parsed.repo, branch);
    
    if (!data.tree || data.tree.length === 0) {
      setStatus('WARNING: NO FILES FOUND IN REPOSITORY', 'error');
      allFiles = [];
      renderTable();
      return;
    }
    
    allFiles = data.tree
      .filter(item => item.type === 'blob')
      .map(item => ({
        path: item.path,
        size: item.size,
        type: item.path.includes('.') ? item.path.split('.').pop().toUpperCase() : 'FILE',
        url: `https://github.com/${parsed.owner}/${parsed.repo}/blob/${branch}/${item.path}`,
        rawUrl: `https://raw.githubusercontent.com/${parsed.owner}/${parsed.repo}/${branch}/${item.path}`
      }));
    
    setStatus(`SCAN COMPLETE - ${allFiles.length} FILES DETECTED`, 'success');
    renderTable();
    
  } catch (error) {
    console.error(error);
    setStatus(`SCAN FAILED: ${error.message}`, 'error');
    allFiles = [];
    renderTable();
  }
}

function renderTable() {
  const ext = extFilter.value.toLowerCase();
  const query = searchBox.value.toLowerCase().trim();
  
  let filtered = allFiles.filter(file => {
    const matchExt = !ext || file.path.toLowerCase().endsWith(ext);
    const matchQuery = !query || file.path.toLowerCase().includes(query);
    return matchExt && matchQuery;
  });
  
  // Update stats
  const totalSize = allFiles.reduce((sum, f) => sum + (f.size || 0), 0);
  document.getElementById('totalFiles').textContent = allFiles.length;
  document.getElementById('displayedFiles').textContent = filtered.length;
  document.getElementById('totalSize').textContent = formatBytes(totalSize);
  
  if (allFiles.length > 0) {
    statsArea.style.display = 'flex';
  }
  
  if (filtered.length === 0) {
    tableContainer.style.display = 'none';
    noData.style.display = 'block';
    return;
  }
  
  tableBody.innerHTML = '';
  noData.style.display = 'none';
  tableContainer.style.display = 'block';
  
  filtered.sort((a, b) => a.path.localeCompare(b.path));
  
  filtered.forEach(file => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td><span class="file-icon">${getFileIcon(file.path)}</span>${file.path}</td>
      <td>${formatBytes(file.size)}</td>
      <td>${file.type}</td>
      <td>
        <a href="${file.url}" target="_blank" rel="noopener">VIEW</a> | 
        <a href="${file.rawUrl}" target="_blank" rel="noopener">RAW</a>
      </td>
    `;
    tableBody.appendChild(tr);
  });
}

scanBtn.addEventListener('click', scanRepository);
extFilter.addEventListener('change', renderTable);
searchBox.addEventListener('input', renderTable);

repoUrlInput.addEventListener('keypress', (e) => {
  if (e.key === 'Enter') scanRepository();
});

// Auto-scan if URL in query string
const params = new URLSearchParams(window.location.search);
const repoParam = params.get('repo');
if (repoParam) {
  repoUrlInput.value = repoParam;
  scanRepository();
}
</script>
</body>
</html>
